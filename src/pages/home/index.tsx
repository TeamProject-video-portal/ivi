import Head from "next/head";
import { Inter } from "next/font/google";
import Banner from "@/components/Banner";
import SliderContinueBrowsing from "@/components/Sliders/SliderContinueBrowsing";
import { useTranslation } from "next-export-i18n";
import { FC, useEffect, useState } from "react";
import SliderTopTen from "@/components/Sliders/SliderTopTen";
import SimpleSlider from "@/components/Sliders/SimpleSlider";
import dataFilms from "@/data/Search_films_v2.json";
import main_banner from "@/data/Main_banner.json";
import { ISimpleMovie, IMovie, BannerType } from "@/types/types";
import { GetServerSideProps, GetStaticProps } from "next";
import { connect, useDispatch, useSelector } from "react-redux";
import { wrapper } from "@/Redux/store";
import { DATA_BANNER } from "@/Redux/banner/action-types";
import { selectBanner } from "@/Redux/banner/selectors";

const inter = Inter({ subsets: ["latin"] });
type Props = {
  startMovies: any;
  error: any;
};

const Home: FC<Props> = () => {
  // const [data, setData] = useState(startMovies);
  const dataBanner = useSelector(selectBanner);
  const { t } = useTranslation();
  return (
    <>
      <Head>
        <title>IVI</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
        <meta httpEquiv="Permissions-Policy" content="interest-cohort=()" />
      </Head>
      <Banner movies={dataBanner.data} />
      <SliderContinueBrowsing
        title={t("sliders_title.continue_browsing")}
        type={"summary"}
      />
      <SliderTopTen films={dataFilms as ISimpleMovie[]} />

      <SimpleSlider
        title={t("sliders_title.modern_cartoons")}
        films={dataFilms as ISimpleMovie[]}
      />
    </>
  );
};

// export const getStaticProps: GetStaticProps = async (ctx) => {
// try {
// const res = await axios({
//   method: "get",
//   url: "https://api.kinopoisk.dev/v1.3/movie",
//   headers: {
//     "Content-Type": "application/json",
//     "X-API-KEY": `13RH6Q2-2T1M1E7-M50R852-366EP7D`,
//     "X-Frame-Options": "SAMEORIGIN",
//   },
//   params: {
//     Application: "13RH6Q2-2T1M1E7-M50R852-366EP7D",
//     selectFields: "videos year id poster logo",
//     year: 2020,
//   },
// });
// const put = useDispatch();
// const res = main_banner as BannerType[];
// put(bannerReducer(main_banner, GET_BANNER));

// return {
//   props: {
// startMovies: res,
//   },
// };
// } catch {
//   const res = [main_banner as BannerType[]];
//   return {
//     props: {
//       startMovies: [],
//     },
//   };
// }
// };

export const gerServerSideProps: GetServerSideProps =
  wrapper.getServerSideProps((store) => async (context) => {
    const res = main_banner;
    store.dispatch({
      type: DATA_BANNER.GET_DATA_BANNER,
      payload: res,
    });
    return { props: {} };
  });
export default connect((state) => state)(Home);
